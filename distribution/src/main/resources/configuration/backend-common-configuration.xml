<?xml version="1.0" encoding="UTF-8"?>
<!--
  ~ Copyright 2015 e-CODEX Project
  ~
  ~ Licensed under the EUPL, Version 1.1 or â€“ as soon they
  ~ will be approved by the European Commission - subsequent
  ~ versions of the EUPL (the "Licence");
  ~ You may not use this work except in compliance with the
  ~ Licence.
  ~ You may obtain a copy of the Licence at:
  ~ http://ec.europa.eu/idabc/eupl5
  ~ Unless required by applicable law or agreed to in
  ~ writing, software distributed under the Licence is
  ~ distributed on an "AS IS" basis,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either
  ~ express or implied.
  ~ See the Licence for the specific language governing
  ~ permissions and limitations under the Licence.
  -->

<beans xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:util="http://www.springframework.org/schema/util"
       xmlns:sec="http://www.springframework.org/schema/security"
       xmlns="http://www.springframework.org/schema/beans"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/util
        http://www.springframework.org/schema/util/spring-util.xsd
        http://www.springframework.org/schema/security
	    http://www.springframework.org/schema/security/spring-security-3.2.xsd">

    <!-- database configuration -->
    <bean id="entityManagerFactory"
          class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
        <!-- the datasource to be used by domibus -->
        <property name="dataSource" ref="dataSource"/>
        <!-- package to scan for autodetection of entity classes
        This value should not be changed -->
        <property name="packagesToScan" value="eu.domibus"/>
        <!-- This adapter allows to plug in vendor specific behaviour into the
        Spring EntityManager -->
        <property name="jpaVendorAdapter">
            <!-- By default a HibernateJpaVendorAdapter is used -->
            <bean class="org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter"/>
        </property>
        <!-- The validation mode to be used by the provider for the persistence unit  -->
        <property name="validationMode" value="AUTO"/>
        <!-- Properties for the jpa configuration -->
        <property name="jpaProperties">
            <props>
                <!-- Automatic validation of the database schema when session
                factory is created -could be disabled by setting to "none" -->
                <prop key="hibernate.hbm2ddl.auto">validate</prop>
                <!-- database dialect to use -->
                <prop key="hibernate.dialect">
                    org.hibernate.dialect.MySQL5InnoDBDialect
                </prop>
                <!-- Log all SQL statements to console - FOR DEBUGGING PURPOSES -->
                <prop key="hibernate.show_sql">false</prop>
                <!-- format SQL statements before logging - only used when
                hibernate.show_sql=true -->
                <prop key="hibernate.format_sql">true</prop>
                <!-- generate comments inside SQL statements - only used when
                hibernate.show_sql=true -->
                <prop key="hibernate.use_sql_comments">true</prop>
            </props>
        </property>
    </bean>

    <!-- database pooling provider -->
    <bean id="dataSource" class="org.springframework.jndi.JndiObjectFactoryBean">
        <property name="jndiName" value="java:/jdbc/cipaeDeliveryDs"/>
    </bean>

    <!-- Internal configuration provider. Do not change unless you have special requirements (i.e. dynamic
    discovery injection of PModes)-->
    <bean id="pModeProvider"
          class="eu.domibus.ebms3.common.dao.PModeDao"
          init-method="init"/>

    <!-- General domibus properties -->
    <util:properties id="domibusProperties">
        <!-- The suffix of the messageId generated by this instance of domibus.
        Schema is:  ${UUID}@${SUFFIX} -->
        <prop key="domibus.msh.messageid.suffix">e-delivery.eu</prop>
        <!-- Sender Worker execution interval as a cron expression -->
        <prop key="domibus.msh.sender.cron">0/5 * * * * ?</prop>
        <!-- Should unrecoverable errors should be retried or not -->
        <prop key="domibus.dispatch.ebms.error.unrecoverable.retry">true</prop>
        <prop key="domibus.recipient.wsdl">http://localhost:8088/mockDomibusServiceWSImplServiceSoapBinding?WSDL</prop>
        <prop key="domibus.recipient.namespaceURI">eu:europa:ec:cipa:domibus:services</prop>
        <prop key="domibus.recipient.localPart">DomibusServiceWSImplService</prop>
    </util:properties>

    <!-- Mimetypes listed in this map will not be compressed (in outgoing messages)
    even if compression is turned on for the given message. -->
    <util:list id="compressionBlacklist" value-type="java.lang.String">
        <value>application/vnd.etsi.asic-s+zip</value>
        <value>image/jpeg</value>
    </util:list>

</beans>
