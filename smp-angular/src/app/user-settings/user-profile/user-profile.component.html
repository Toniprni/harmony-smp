<div id="user-profile-panel">
  <form [formGroup]="userForm" (ngSubmit)="onSaveButtonClicked()">
    <data-panel title="Account"
                text="Account data">
      <mat-form-field class="user-profile-pane-field">
        <mat-label>Username</mat-label>
        <input matInput placeholder="Username" formControlName="username"
               id="username_id" maxlength="255">
      </mat-form-field>
      <mat-form-field class="user-profile-pane-field">
        <mat-label>Role</mat-label>
        <input matInput placeholder="role" formControlName="role"
               id="Role" maxlength="255">
      </mat-form-field>
    </data-panel>

    <data-panel title="User profile"
                text="User profile data and settings">
      <mat-form-field class="user-profile-pane-field">
        <mat-label>E-Mail Address</mat-label>
        <input matInput placeholder="EMail Address" formControlName="emailAddress"
               id="emailAddress_id" maxlength="255">
        <div
          *ngIf="userForm.controls['emailAddress'].hasError('pattern') && userForm.controls['emailAddress'].touched"
          class="has-error">Email is invalid!
        </div>
      </mat-form-field>
      <mat-form-field class="user-profile-pane-field">
        <mat-label>Full name (name and last name)</mat-label>
        <input matInput placeholder="Full name" formControlName="fullName"
               id="fullName" maxlength="255">
      </mat-form-field>

      <mat-form-field class="user-profile-pane-field">
        <mat-label>Theme</mat-label>
        <select matNativeControl
                (change)="onThemeSelect($event.target.value)"
                formControlName="smpTheme">
          <option *ngFor="let item of themeItems" [value]="item.className">{{item.name}}</option>
        </select>
      </mat-form-field>
      <div class="user-profile-pane-field" style="display:flex;flex-direction: row">
        <mat-form-field style="flex-grow: 1">
          <mat-label>Locale (Date/time formatting)</mat-label>
          <select matNativeControl id="moment-locale"
                  (change)="onLocaleSelect($event.target.value)"
                  formControlName="smpLocale"
          >
            <option value="bg">Bulgarian</option>
            <option value="cs">Czech</option>
            <option value="da">Danish</option>
            <option value="de">German</option>
            <option value="el">Greek</option>
            <option value="en">English</option>
            <option value="es">Spanish</option>
            <option value="et">Estonian</option>
            <option value="fi">Finnish</option>
            <option value="fr">French</option>
            <option value="hr">Croatian</option>
            <option value="hu">Hungarian</option>
            <option value="it">Italian</option>
            <option value="lt">Lithuanian</option>
            <option value="lv">Latvian</option>
            <option value="mt">Maltese</option>
            <option value="nl">Dutch</option>
            <option value="pl">Polish</option>
            <option value="pt">Portuguese</option>
            <option value="ro">Romanian</option>
            <option value="sk">Slovak</option>
            <option value="sl">Slovenian</option>
            <option value="sv">Swedish</option>
          </select>


        </mat-form-field>
        <mat-form-field style="flex-grow: 1">
          <mat-label>Example of Date/time</mat-label>
          <input matInput [ngxMatDatetimePicker]="picker" placeholder="Choose a date"
                 [value]="currentDate"
                 >
          <mat-datepicker-toggle matSuffix [for]="picker" style="visibility: visible"></mat-datepicker-toggle>
          <ngx-mat-datetime-picker #picker [showSpinners]="true" [showSeconds]="false" [stepHour]="1"
                                   [stepMinute]="1" [stepSecond]="1"
                                   [hideTime]="false"
          >

          </ngx-mat-datetime-picker>
        </mat-form-field>
      </div>
      <!-- buttons  -->
      <div id="user-profile-panel-toolbar" class="panel">
        <button id="cancelButton" mat-raised-button (click)="onResetButtonClicked()" color="primary"
                [disabled]="!resetButtonEnabled">
          <mat-icon>refresh</mat-icon>
          <span>Reset</span>
        </button>
        <button id="saveButton" mat-raised-button (click)="onSaveButtonClicked()" color="primary"
                [disabled]="!submitButtonEnabled">
          <mat-icon>save</mat-icon>
          <span>Save</span>
        </button>
      </div>
    </data-panel>
  </form>
  <form [formGroup]="userCredentialForm" (ngSubmit)="onSaveButtonClicked()">
    <data-panel *ngIf="true" title="Username/password credentials"
                text="Reset username password for the UI login">
      <div style="display: flex;flex-flow: row wrap;">
        <mat-form-field style="flex-grow: 1">
          <mat-label>Last set</mat-label>
          <input matInput placeholder="Last set"
                 value="{{!userCredentialForm.get('passwordUpdatedOn').value?nullValue:userCredentialForm.get('passwordUpdatedOn').value | date:dateTimeFormat}}"
                 maxlength="255" disabled>
        </mat-form-field>

        <mat-form-field style="flex-grow: 1">
          <mat-label>Password expire on</mat-label>
          <input *ngIf="!!userCredentialForm.get('passwordExpireOn').value; else noPasswordExpirySet " matInput
                 placeholder="Valid until"
                 value="{{userCredentialForm.get('passwordExpireOn').value | date:dateTimeFormat}}"
                 maxlength="255" disabled>
          <ng-template #noPasswordExpirySet>
            <input matInput placeholder="Valid until" style="color: red"
                   matTooltip="Default password set by system admin! User must change password immediately!"
                   value="Default or null password"
                   maxlength="255" disabled>
          </ng-template>
        </mat-form-field>
      </div>
      <div style="display: flex;flex-flow: row wrap;">
        <mat-form-field style="flex-grow: 2">
          <mat-label>Seq. failed attempts</mat-label>
          <input matInput placeholder="Seq. failed attempts"
                 [value]="userCredentialForm.controls['sequentialLoginFailureCount'].value"
                 id="sequentialLoginFailureCount_id" maxlength="255" disabled readonly>
        </mat-form-field>
        <mat-form-field style="flex-grow: 1">
          <mat-label>Last failed attempt</mat-label>
          <input matInput placeholder="Last failed attempt"
                 value="{{!userCredentialForm.get('lastFailedLoginAttempt').value?nullValue:userCredentialForm.get('lastFailedLoginAttempt').value | date:dateTimeFormat}}"
                 maxlength="255" disabled>
        </mat-form-field>
      </div>
      <div style="display: flex;flex-flow: row wrap;">
        <mat-form-field style="flex-grow: 1">
          <mat-label>Suspended until</mat-label>
          <input matInput placeholder="Suspended until"
                 value="{{!userCredentialForm.get('suspendedUtil').value?nullValue:userCredentialForm.get('suspendedUtil').value | date:dateTimeFormat}}"
                 maxlength="255" disabled>
        </mat-form-field>
      </div>


      <div id="user-password-reset-panel-toolbar" class="panel">
        <button mat-flat-button color="primary" id="changePassword_id"
                (click)="changeCurrentUserPassword()">
          <span>Set/change password</span>
        </button>
      </div>
    </data-panel>
  </form>
</div>

